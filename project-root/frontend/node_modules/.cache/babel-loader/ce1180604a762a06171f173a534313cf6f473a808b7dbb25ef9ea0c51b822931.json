{"ast":null,"code":"import * as pdfMake from \"pdfmake/build/pdfmake\";\nimport * as pdfFonts from \"pdfmake/build/vfs_fonts\";\nimport logoBase64 from \"./logo\";\nimport { pdfIntroBlock } from \"./pdfIntroBlock\";\nimport { pdfDominantPatternsBlock } from \"./pdfDominantPatternsBlock\";\nimport { pdfCategoryPatternsBlock } from \"./pdfCategoryPatternsBlock\";\nimport { pdfContactsBlock, pdfRepeatTestBlock, pdfAuthorBlock, pdfDominantPatternsDescriptionsBlock } from \"./pdfContactsBlock\";\nimport { getPatternPercentsByCategory } from \"../../utils/resultsHelpers\";\nimport pdfmakeStyles from \"./pdfmakeStyles\";\npdfMake.vfs = pdfFonts.vfs;\nfunction isTelegramWebView() {\n  return /Telegram/i.test(navigator.userAgent);\n}\nexport function downloadPDF(resultsData) {\n  if (!resultsData) {\n    alert(\"Нет данных для создания PDF!\");\n    return;\n  }\n  const dominantPatternResults = getPatternPercentsByCategory(resultsData.categories, resultsData.patternResults);\n  const docDefinition = {\n    content: [...pdfIntroBlock(resultsData, logoBase64), ...pdfDominantPatternsBlock(resultsData.categories, dominantPatternResults), ...pdfCategoryPatternsBlock(resultsData.categories, resultsData.patternResults), ...pdfContactsBlock(), ...pdfRepeatTestBlock(), ...pdfAuthorBlock(), ...pdfDominantPatternsDescriptionsBlock(resultsData.categories, dominantPatternResults)],\n    styles: pdfmakeStyles,\n    footer: (currentPage, pageCount) => ({\n      text: `Страница ${currentPage} из ${pageCount}`,\n      alignment: \"center\",\n      margin: [0, 10],\n      style: \"pages\"\n    }),\n    pageMargins: [40, 60, 40, 60]\n  };\n  if (isTelegramWebView()) {\n    alert(\"В браузере Telegram автоматическая загрузка PDF не поддерживается.\\nPDF откроется в новом окне — сохраните его вручную через меню браузера.\");\n    pdfMake.createPdf(docDefinition).open();\n  } else {\n    pdfMake.createPdf(docDefinition).download(\"results.pdf\");\n  }\n}\n\n// <-- ВАЖНО: это снаружи функций -->\nif (typeof window !== 'undefined') {\n  window.generateDocDefinition = resultsData => {\n    const dominantPatternResults = getPatternPercentsByCategory(resultsData.categories, resultsData.patternResults);\n    return {\n      content: [...pdfIntroBlock(resultsData, logoBase64), ...pdfDominantPatternsBlock(resultsData.categories, dominantPatternResults), ...pdfCategoryPatternsBlock(resultsData.categories, resultsData.patternResults), ...pdfContactsBlock(), ...pdfRepeatTestBlock(), ...pdfAuthorBlock(), ...pdfDominantPatternsDescriptionsBlock(resultsData.categories, dominantPatternResults)],\n      styles: pdfmakeStyles,\n      footer: (currentPage, pageCount) => ({\n        text: `Страница ${currentPage} из ${pageCount}`,\n        alignment: \"center\",\n        margin: [0, 10],\n        style: \"pages\"\n      }),\n      pageMargins: [40, 80, 40, 60]\n    };\n  };\n}","map":{"version":3,"names":["pdfMake","pdfFonts","logoBase64","pdfIntroBlock","pdfDominantPatternsBlock","pdfCategoryPatternsBlock","pdfContactsBlock","pdfRepeatTestBlock","pdfAuthorBlock","pdfDominantPatternsDescriptionsBlock","getPatternPercentsByCategory","pdfmakeStyles","vfs","isTelegramWebView","test","navigator","userAgent","downloadPDF","resultsData","alert","dominantPatternResults","categories","patternResults","docDefinition","content","styles","footer","currentPage","pageCount","text","alignment","margin","style","pageMargins","createPdf","open","download","window","generateDocDefinition"],"sources":["F:/web/ЗАКАЗЫ/АЙФОРДЖИ/project-pattern-test/project-root/frontend/src/utils/pdf/pdfmakeGenerator.js"],"sourcesContent":["import * as pdfMake from \"pdfmake/build/pdfmake\";\r\nimport * as pdfFonts from \"pdfmake/build/vfs_fonts\";\r\nimport logoBase64 from \"./logo\";\r\nimport { pdfIntroBlock } from \"./pdfIntroBlock\";\r\nimport { pdfDominantPatternsBlock } from \"./pdfDominantPatternsBlock\";\r\nimport { pdfCategoryPatternsBlock } from \"./pdfCategoryPatternsBlock\";\r\nimport { pdfContactsBlock, pdfRepeatTestBlock, pdfAuthorBlock, pdfDominantPatternsDescriptionsBlock } from \"./pdfContactsBlock\";\r\nimport { getPatternPercentsByCategory } from \"../../utils/resultsHelpers\";\r\nimport pdfmakeStyles from \"./pdfmakeStyles\";\r\n\r\npdfMake.vfs = pdfFonts.vfs;\r\n\r\nfunction isTelegramWebView() {\r\n  return /Telegram/i.test(navigator.userAgent);\r\n}\r\n\r\nexport function downloadPDF(resultsData) {\r\n  if (!resultsData) {\r\n    alert(\"Нет данных для создания PDF!\");\r\n    return;\r\n  }\r\n\r\n  const dominantPatternResults = getPatternPercentsByCategory(\r\n    resultsData.categories,\r\n    resultsData.patternResults\r\n  );\r\n\r\n  const docDefinition = {\r\n    content: [\r\n      ...pdfIntroBlock(resultsData, logoBase64),\r\n      ...pdfDominantPatternsBlock(resultsData.categories, dominantPatternResults),\r\n      ...pdfCategoryPatternsBlock(resultsData.categories, resultsData.patternResults),\r\n      ...pdfContactsBlock(),\r\n      ...pdfRepeatTestBlock(),\r\n      ...pdfAuthorBlock(),\r\n      ...pdfDominantPatternsDescriptionsBlock(resultsData.categories, dominantPatternResults),\r\n    ],\r\n    styles: pdfmakeStyles,\r\n    footer: (currentPage, pageCount) => ({\r\n      text: `Страница ${currentPage} из ${pageCount}`,\r\n      alignment: \"center\",\r\n      margin: [0, 10],\r\n      style: \"pages\",\r\n    }),\r\n    pageMargins: [40, 60, 40, 60],\r\n  };\r\n\r\n  if (isTelegramWebView()) {\r\n    alert(\"В браузере Telegram автоматическая загрузка PDF не поддерживается.\\nPDF откроется в новом окне — сохраните его вручную через меню браузера.\");\r\n    pdfMake.createPdf(docDefinition).open();\r\n  } else {\r\n    pdfMake.createPdf(docDefinition).download(\"results.pdf\");\r\n  }\r\n}\r\n\r\n// <-- ВАЖНО: это снаружи функций -->\r\nif (typeof window !== 'undefined') {\r\n  window.generateDocDefinition = (resultsData) => {\r\n    const dominantPatternResults = getPatternPercentsByCategory(\r\n      resultsData.categories,\r\n      resultsData.patternResults\r\n    );\r\n\r\n    return {\r\n      content: [\r\n        ...pdfIntroBlock(resultsData, logoBase64),\r\n        ...pdfDominantPatternsBlock(resultsData.categories, dominantPatternResults),\r\n        ...pdfCategoryPatternsBlock(resultsData.categories, resultsData.patternResults),\r\n        ...pdfContactsBlock(),\r\n        ...pdfRepeatTestBlock(),\r\n        ...pdfAuthorBlock(),\r\n        ...pdfDominantPatternsDescriptionsBlock(resultsData.categories, dominantPatternResults),\r\n      ],\r\n      styles: pdfmakeStyles,\r\n      footer: (currentPage, pageCount) => ({\r\n        text: `Страница ${currentPage} из ${pageCount}`,\r\n        alignment: \"center\",\r\n        margin: [0, 10],\r\n        style: \"pages\",\r\n      }),\r\n      pageMargins: [40, 80, 40, 60],\r\n    };\r\n  };\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}