{"ast":null,"code":"import { DIRECTION } from '../../core/utils.js';\nclass PatternCursor {\n  constructor(masked, pos) {\n    this.masked = masked;\n    this._log = [];\n    const {\n      offset,\n      index\n    } = masked._mapPosToBlock(pos) || (pos < 0 ?\n    // first\n    {\n      index: 0,\n      offset: 0\n    } :\n    // last\n    {\n      index: this.masked._blocks.length,\n      offset: 0\n    });\n    this.offset = offset;\n    this.index = index;\n    this.ok = false;\n  }\n  get block() {\n    return this.masked._blocks[this.index];\n  }\n  get pos() {\n    return this.masked._blockStartPos(this.index) + this.offset;\n  }\n  get state() {\n    return {\n      index: this.index,\n      offset: this.offset,\n      ok: this.ok\n    };\n  }\n  set state(s) {\n    Object.assign(this, s);\n  }\n  pushState() {\n    this._log.push(this.state);\n  }\n  popState() {\n    const s = this._log.pop();\n    if (s) this.state = s;\n    return s;\n  }\n  bindBlock() {\n    if (this.block) return;\n    if (this.index < 0) {\n      this.index = 0;\n      this.offset = 0;\n    }\n    if (this.index >= this.masked._blocks.length) {\n      this.index = this.masked._blocks.length - 1;\n      this.offset = this.block.displayValue.length; // TODO this is stupid type error, `block` depends on index that was changed above\n    }\n  }\n  _pushLeft(fn) {\n    this.pushState();\n    for (this.bindBlock(); 0 <= this.index; --this.index, this.offset = ((_this$block = this.block) == null ? void 0 : _this$block.displayValue.length) || 0) {\n      var _this$block;\n      if (fn()) return this.ok = true;\n    }\n    return this.ok = false;\n  }\n  _pushRight(fn) {\n    this.pushState();\n    for (this.bindBlock(); this.index < this.masked._blocks.length; ++this.index, this.offset = 0) {\n      if (fn()) return this.ok = true;\n    }\n    return this.ok = false;\n  }\n  pushLeftBeforeFilled() {\n    return this._pushLeft(() => {\n      if (this.block.isFixed || !this.block.value) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.FORCE_LEFT);\n      if (this.offset !== 0) return true;\n    });\n  }\n  pushLeftBeforeInput() {\n    // cases:\n    // filled input: 00|\n    // optional empty input: 00[]|\n    // nested block: XX<[]>|\n    return this._pushLeft(() => {\n      if (this.block.isFixed) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.LEFT);\n      return true;\n    });\n  }\n  pushLeftBeforeRequired() {\n    return this._pushLeft(() => {\n      if (this.block.isFixed || this.block.isOptional && !this.block.value) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.LEFT);\n      return true;\n    });\n  }\n  pushRightBeforeFilled() {\n    return this._pushRight(() => {\n      if (this.block.isFixed || !this.block.value) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.FORCE_RIGHT);\n      if (this.offset !== this.block.value.length) return true;\n    });\n  }\n  pushRightBeforeInput() {\n    return this._pushRight(() => {\n      if (this.block.isFixed) return;\n\n      // const o = this.offset;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.NONE);\n      // HACK cases like (STILL DOES NOT WORK FOR NESTED)\n      // aa|X\n      // aa<X|[]>X_    - this will not work\n      // if (o && o === this.offset && this.block instanceof PatternInputDefinition) continue;\n      return true;\n    });\n  }\n  pushRightBeforeRequired() {\n    return this._pushRight(() => {\n      if (this.block.isFixed || this.block.isOptional && !this.block.value) return;\n\n      // TODO check |[*]XX_\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.NONE);\n      return true;\n    });\n  }\n}\nexport { PatternCursor as default };","map":{"version":3,"names":["DIRECTION","PatternCursor","constructor","masked","pos","_log","offset","index","_mapPosToBlock","_blocks","length","ok","block","_blockStartPos","state","s","Object","assign","pushState","push","popState","pop","bindBlock","displayValue","_pushLeft","fn","_this$block","_pushRight","pushLeftBeforeFilled","isFixed","value","nearestInputPos","FORCE_LEFT","pushLeftBeforeInput","LEFT","pushLeftBeforeRequired","isOptional","pushRightBeforeFilled","FORCE_RIGHT","pushRightBeforeInput","NONE","pushRightBeforeRequired","default"],"sources":["F:/web/ЗАКАЗЫ/АЙФОРДЖИ/project-pattern-test/project-root/frontend/node_modules/imask/esm/masked/pattern/cursor.js"],"sourcesContent":["import { DIRECTION } from '../../core/utils.js';\n\nclass PatternCursor {\n  constructor(masked, pos) {\n    this.masked = masked;\n    this._log = [];\n    const {\n      offset,\n      index\n    } = masked._mapPosToBlock(pos) || (pos < 0 ?\n    // first\n    {\n      index: 0,\n      offset: 0\n    } :\n    // last\n    {\n      index: this.masked._blocks.length,\n      offset: 0\n    });\n    this.offset = offset;\n    this.index = index;\n    this.ok = false;\n  }\n  get block() {\n    return this.masked._blocks[this.index];\n  }\n  get pos() {\n    return this.masked._blockStartPos(this.index) + this.offset;\n  }\n  get state() {\n    return {\n      index: this.index,\n      offset: this.offset,\n      ok: this.ok\n    };\n  }\n  set state(s) {\n    Object.assign(this, s);\n  }\n  pushState() {\n    this._log.push(this.state);\n  }\n  popState() {\n    const s = this._log.pop();\n    if (s) this.state = s;\n    return s;\n  }\n  bindBlock() {\n    if (this.block) return;\n    if (this.index < 0) {\n      this.index = 0;\n      this.offset = 0;\n    }\n    if (this.index >= this.masked._blocks.length) {\n      this.index = this.masked._blocks.length - 1;\n      this.offset = this.block.displayValue.length; // TODO this is stupid type error, `block` depends on index that was changed above\n    }\n  }\n  _pushLeft(fn) {\n    this.pushState();\n    for (this.bindBlock(); 0 <= this.index; --this.index, this.offset = ((_this$block = this.block) == null ? void 0 : _this$block.displayValue.length) || 0) {\n      var _this$block;\n      if (fn()) return this.ok = true;\n    }\n    return this.ok = false;\n  }\n  _pushRight(fn) {\n    this.pushState();\n    for (this.bindBlock(); this.index < this.masked._blocks.length; ++this.index, this.offset = 0) {\n      if (fn()) return this.ok = true;\n    }\n    return this.ok = false;\n  }\n  pushLeftBeforeFilled() {\n    return this._pushLeft(() => {\n      if (this.block.isFixed || !this.block.value) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.FORCE_LEFT);\n      if (this.offset !== 0) return true;\n    });\n  }\n  pushLeftBeforeInput() {\n    // cases:\n    // filled input: 00|\n    // optional empty input: 00[]|\n    // nested block: XX<[]>|\n    return this._pushLeft(() => {\n      if (this.block.isFixed) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.LEFT);\n      return true;\n    });\n  }\n  pushLeftBeforeRequired() {\n    return this._pushLeft(() => {\n      if (this.block.isFixed || this.block.isOptional && !this.block.value) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.LEFT);\n      return true;\n    });\n  }\n  pushRightBeforeFilled() {\n    return this._pushRight(() => {\n      if (this.block.isFixed || !this.block.value) return;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.FORCE_RIGHT);\n      if (this.offset !== this.block.value.length) return true;\n    });\n  }\n  pushRightBeforeInput() {\n    return this._pushRight(() => {\n      if (this.block.isFixed) return;\n\n      // const o = this.offset;\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.NONE);\n      // HACK cases like (STILL DOES NOT WORK FOR NESTED)\n      // aa|X\n      // aa<X|[]>X_    - this will not work\n      // if (o && o === this.offset && this.block instanceof PatternInputDefinition) continue;\n      return true;\n    });\n  }\n  pushRightBeforeRequired() {\n    return this._pushRight(() => {\n      if (this.block.isFixed || this.block.isOptional && !this.block.value) return;\n\n      // TODO check |[*]XX_\n      this.offset = this.block.nearestInputPos(this.offset, DIRECTION.NONE);\n      return true;\n    });\n  }\n}\n\nexport { PatternCursor as default };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}