{"ast":null,"code":"import React,{useState}from\"react\";import OfferIntroSection from\"../Sections/IntroSections/OfferIntroSection\";import PatternsIntroSection from\"../Sections/IntroSections/PatternsIntroSection\";import InstructionIntroSection from\"../Sections/IntroSections/InstructionIntroSection\";import ContactsIntroSection from\"../Sections/IntroSections/ContactsIntroSection\";import StartTestIntroSection from\"../Sections/IntroSections/StartTestIntroSection\";import FormScreen from\"../Screens/FormScreen\";import QuestionsScreen from\"../Screens/QuestionsScreen\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PatternTestEntry=()=>{const[step,setStep]=useState(\"intro\");const[userData,setUserData]=useState(null);// answers и patterns\nconst[answers,setAnswers]=useState([]);const[patterns,setPatterns]=useState([]);const[resultId,setResultId]=useState(null);const[error,setError]=useState(\"\");const[timeDisplay,setTimeDisplay]=useState(\"\");if(step===\"intro\"){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(OfferIntroSection,{}),/*#__PURE__*/_jsx(PatternsIntroSection,{}),/*#__PURE__*/_jsx(InstructionIntroSection,{}),/*#__PURE__*/_jsx(ContactsIntroSection,{}),/*#__PURE__*/_jsx(StartTestIntroSection,{onStart:()=>setStep(\"form\")})]});}if(step===\"form\"){return/*#__PURE__*/_jsx(FormScreen,{onSubmit:formData=>{setUserData(formData);setTimeDisplay(new Date().toLocaleDateString(\"ru-RU\"));setStep(\"questions\");},onBack:()=>setStep(\"intro\")});}if(step===\"questions\"){return/*#__PURE__*/_jsx(QuestionsScreen,{userData:userData,timeDisplay:timeDisplay,onComplete:_ref=>{let{answers,patterns}=_ref;setAnswers(answers);setPatterns(patterns);// Сохраняем patterns!\nsetStep(\"loading\");// Отправляем ответы и паттерны на сервер!\nsendResults({userData,answers,patterns,date:timeDisplay});},onBack:()=>setStep(\"form\")});}if(step===\"loading\"){return/*#__PURE__*/_jsx(\"div\",{style:{textAlign:\"center\",marginTop:40},children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u044F\\u0435\\u043C \\u0432\\u0430\\u0448\\u0438 \\u0440\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442\\u044B...\"});}if(step===\"resultLink\"){if(error){return/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\",textAlign:\"center\",marginTop:40},children:[\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0441\\u043E\\u0445\\u0440\\u0430\\u043D\\u0435\\u043D\\u0438\\u0438: \",error,/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setStep(\"questions\"),children:\"\\u041F\\u043E\\u043F\\u0440\\u043E\\u0431\\u043E\\u0432\\u0430\\u0442\\u044C \\u0435\\u0449\\u0451 \\u0440\\u0430\\u0437\"})]});}return/*#__PURE__*/_jsx(\"div\",{className:\"test-completed\",style:{textAlign:\"center\",marginTop:40},children:/*#__PURE__*/_jsx(\"div\",{className:\"test-completed__container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"test-completed__body\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"test-completed__title\",children:\"\\u0422\\u0435\\u0441\\u0442 \\u0437\\u0430\\u0432\\u0435\\u0440\\u0448\\u0435\\u043D! \"}),/*#__PURE__*/_jsx(\"h3\",{className:\"test-completed__subtitle\",children:\"\\u0421\\u043F\\u0430\\u0441\\u0438\\u0431\\u043E \\u0437\\u0430 \\u0443\\u0447\\u0430\\u0441\\u0442\\u0438\\u0435 \\u0432 \\u0438\\u0441\\u0441\\u043B\\u0435\\u0434\\u043E\\u0432\\u0430\\u043D\\u0438\\u0438 \\u043F\\u0430\\u0442\\u0442\\u0435\\u0440\\u043D\\u043E\\u0432!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"test-completed__text\",children:\"\\u0412\\u0430\\u0448\\u0438 \\u0440\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442\\u044B \\u0442\\u0435\\u0441\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u044F \\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B \\u043F\\u043E \\u0441\\u0441\\u044B\\u043B\\u043A\\u0435:\"}),/*#__PURE__*/_jsx(\"a\",{className:\"patterns-button \",href:`/pattern-test/results/${resultId}`,children:\"\\u041F\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\\u0435\\u0442\\u044C \\u0440\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442\"}),/*#__PURE__*/_jsx(\"br\",{})]})})});}// ------- UTILS -------\nfunction sendResults(_ref2){let{userData,answers,patterns,date}=_ref2;setError(\"\");setResultId(null);fetch(\"/api/pattern-test/submit\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({user:userData,answers,patterns,date})}).then(async res=>{if(!res.ok)throw new Error(\"Ошибка сервера\");const data=await res.json();if(!data.id)throw new Error(\"Не получен ID результата\");localStorage.setItem(`test-result-${data.id}`,JSON.stringify({user:userData,answers,patterns,date}));setResultId(data.id);setStep(\"resultLink\");}).catch(err=>{setError(err.message||\"Ошибка отправки\");setStep(\"resultLink\");});}// ------- /UTILS -------\nreturn null;};export default PatternTestEntry;","map":{"version":3,"names":["React","useState","OfferIntroSection","PatternsIntroSection","InstructionIntroSection","ContactsIntroSection","StartTestIntroSection","FormScreen","QuestionsScreen","jsx","_jsx","jsxs","_jsxs","PatternTestEntry","step","setStep","userData","setUserData","answers","setAnswers","patterns","setPatterns","resultId","setResultId","error","setError","timeDisplay","setTimeDisplay","children","onStart","onSubmit","formData","Date","toLocaleDateString","onBack","onComplete","_ref","sendResults","date","style","textAlign","marginTop","color","onClick","className","href","_ref2","fetch","method","headers","body","JSON","stringify","user","then","res","ok","Error","data","json","id","localStorage","setItem","catch","err","message"],"sources":["F:/web/ЗАКАЗЫ/АЙФОРДЖИ/project-pattern-test/project-root/frontend/src/components/pages/PatternTestEntry.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport OfferIntroSection from \"../Sections/IntroSections/OfferIntroSection\";\r\nimport PatternsIntroSection from \"../Sections/IntroSections/PatternsIntroSection\";\r\nimport InstructionIntroSection from \"../Sections/IntroSections/InstructionIntroSection\";\r\nimport ContactsIntroSection from \"../Sections/IntroSections/ContactsIntroSection\";\r\nimport StartTestIntroSection from \"../Sections/IntroSections/StartTestIntroSection\";\r\nimport FormScreen from \"../Screens/FormScreen\";\r\nimport QuestionsScreen from \"../Screens/QuestionsScreen\";\r\n\r\nconst PatternTestEntry = () => {\r\n\tconst [step, setStep] = useState(\"intro\");\r\n\tconst [userData, setUserData] = useState(null);\r\n\t// answers и patterns\r\n\tconst [answers, setAnswers] = useState([]);\r\n\tconst [patterns, setPatterns] = useState([]);\r\n\tconst [resultId, setResultId] = useState(null);\r\n\tconst [error, setError] = useState(\"\");\r\n\tconst [timeDisplay, setTimeDisplay] = useState(\"\");\r\n\r\n\tif (step === \"intro\") {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<OfferIntroSection />\r\n\t\t\t\t<PatternsIntroSection />\r\n\t\t\t\t<InstructionIntroSection />\r\n\t\t\t\t<ContactsIntroSection />\r\n\t\t\t\t<StartTestIntroSection onStart={() => setStep(\"form\")} />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tif (step === \"form\") {\r\n\t\treturn (\r\n\t\t\t<FormScreen\r\n\t\t\t\tonSubmit={(formData) => {\r\n\t\t\t\t\tsetUserData(formData);\r\n\t\t\t\t\tsetTimeDisplay(new Date().toLocaleDateString(\"ru-RU\"));\r\n\t\t\t\t\tsetStep(\"questions\");\r\n\t\t\t\t}}\r\n\t\t\t\tonBack={() => setStep(\"intro\")}\r\n\t\t\t/>\r\n\r\n\t\t);\r\n\t}\r\n\r\n\tif (step === \"questions\") {\r\n\t\treturn (\r\n\t\t\t<QuestionsScreen\r\n\t\t\t\tuserData={userData}\r\n\t\t\t\ttimeDisplay={timeDisplay}\r\n\t\t\t\tonComplete={({ answers, patterns }) => {\r\n\t\t\t\t\tsetAnswers(answers);\r\n\t\t\t\t\tsetPatterns(patterns); // Сохраняем patterns!\r\n\t\t\t\t\tsetStep(\"loading\");\r\n\t\t\t\t\t// Отправляем ответы и паттерны на сервер!\r\n\t\t\t\t\tsendResults({ userData, answers, patterns, date: timeDisplay });\r\n\t\t\t\t}}\r\n\t\t\t\tonBack={() => setStep(\"form\")}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\r\n\tif (step === \"loading\") {\r\n\t\treturn <div style={{ textAlign: \"center\", marginTop: 40 }}>Сохраняем ваши результаты...</div>;\r\n\t}\r\n\r\n\tif (step === \"resultLink\") {\r\n\t\tif (error) {\r\n\t\t\treturn (\r\n\t\t\t\t<div style={{ color: \"red\", textAlign: \"center\", marginTop: 40 }}>\r\n\t\t\t\t\tОшибка при сохранении: {error}\r\n\t\t\t\t\t<br />\r\n\t\t\t\t\t<button onClick={() => setStep(\"questions\")}>Попробовать ещё раз</button>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<div className=\"test-completed\" style={{ textAlign: \"center\", marginTop: 40 }}>\r\n\t\t\t\t<div className=\"test-completed__container\">\r\n\t\t\t\t\t<div className=\"test-completed__body\">\r\n\t\t\t\t\t\t<h2 className=\"test-completed__title\">Тест завершен! </h2>\r\n\t\t\t\t\t\t<h3 className=\"test-completed__subtitle\">Спасибо за участие в исследовании паттернов!</h3>\r\n\t\t\t\t\t\t<p className=\"test-completed__text\">Ваши результаты тестирования доступны по ссылке:</p>\r\n\t\t\t\t\t\t<a className=\"patterns-button \"\r\n\t\t\t\t\t\t\thref={`/pattern-test/results/${resultId}`}\r\n\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{/* {window.location.origin + `/pattern-test/results/${resultId}`} */}\r\n\t\t\t\t\t\t\tПосмотреть результат\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t<br />\r\n\t\t\t\t\t{/* \tПройти тест ещё раз */}\r\n\t\t\t\t\t\t{/* \t<button className=\"patterns-button patterns-button-primary\" style={{ marginTop: 30 }} onClick={() => setStep(\"intro\")}>Пройти тест ещё раз</button> */}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// ------- UTILS -------\r\n\tfunction sendResults({ userData, answers, patterns, date }) {\r\n\t\tsetError(\"\");\r\n\t\tsetResultId(null);\r\n\t\tfetch(\"/api/pattern-test/submit\", {\r\n\t\t\tmethod: \"POST\",\r\n\t\t\theaders: { \"Content-Type\": \"application/json\" },\r\n\t\t\tbody: JSON.stringify({ user: userData, answers, patterns, date })\r\n\t\t})\r\n\t\t\t.then(async (res) => {\r\n\t\t\t\tif (!res.ok) throw new Error(\"Ошибка сервера\");\r\n\t\t\t\tconst data = await res.json();\r\n\t\t\t\tif (!data.id) throw new Error(\"Не получен ID результата\");\r\n\t\t\t\tlocalStorage.setItem(\r\n\t\t\t\t\t`test-result-${data.id}`,\r\n\t\t\t\t\tJSON.stringify({ user: userData, answers, patterns, date })\r\n\t\t\t\t);\r\n\t\t\t\tsetResultId(data.id);\r\n\t\t\t\tsetStep(\"resultLink\");\r\n\t\t\t})\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tsetError(err.message || \"Ошибка отправки\");\r\n\t\t\t\tsetStep(\"resultLink\");\r\n\t\t\t});\r\n\t}\r\n\r\n\r\n\t// ------- /UTILS -------\r\n\r\n\treturn null;\r\n};\r\n\r\nexport default PatternTestEntry;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}